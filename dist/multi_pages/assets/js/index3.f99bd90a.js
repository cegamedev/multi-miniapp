(function(t){function e(e){for(var n,s,r=e[0],c=e[1],l=e[2],u=0,d=[];u<r.length;u++)s=r[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);p&&p(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o=i[e],n=!0,r=1;r<o.length;r++){var c=o[r];0!==a[c]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=o[0]))}return t}var n={},a={index3:0},i=[];function s(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=n,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/dataStatistics/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var p=c;i.push([3,"chunk-vendors"]),o()})({"0bb1":function(t,e,o){t.exports=o.p+"assets/img/yidabg.fea20cb6.png"},1451:function(t,e,o){t.exports=o.p+"assets/img/weida.0969b4da.png"},"1be8":function(t,e,o){t.exports=o.p+"assets/img/dakaMapbg4.16afd076.png"},"21d1":function(t,e,o){t.exports=o.p+"assets/img/weidabg.1602cc40.png"},"2f6e":function(t,e){t.exports="data:image/png;base64,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"},3:function(t,e,o){t.exports=o("351d")},"351d":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("map-daka")},i=[],s=o("0c7c"),r={},c=Object(s["a"])(r,a,i,!1,null,null,null),l=c.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"map-box"}},[n("div",{attrs:{id:"container"}}),n("div",{staticClass:"top-box"},[n("div",{staticClass:"t"},[n("p",[t._v("你好，我是大明宫第 "+t._s(t.sitesMinderNum)+" 号")]),n("p",[t._v("遗址守护人")])]),n("div",{staticClass:"b"},[t._v("标志景点打卡，点亮属于你和大明宫的故事")])]),n("div",{staticClass:"right-box"},[n("p",{on:{click:t.jumpIndex}},[t._v("景区门票")]),n("p",{on:{click:t.jumpSpotPage}},[t._v("热游榜单")]),n("p",{on:{click:t.jumpRoute}},[t._v("游览路线")]),t.showVideoSlide?n("p",{on:{click:t.jumpVideo}},[t._v("影像明宫")]):t._e()])]),n("div",{staticClass:"tip-box"},[n("img",{staticClass:"icon",attrs:{mode:"widthFix",src:o("ac60")}}),n("div",{staticClass:"item-box"},[n("div",{staticClass:"gundongBox"},[n("div",{staticClass:"gundongList",style:t.gundongAni},[t._v(" "+t._s(t.notice)+" ")])])])]),n("div",{staticClass:"barrage_area"},[n("div",{staticClass:"bulletList"},[n("div",{staticClass:"bulletList-box",attrs:{id:"rollCon"}},[n("div",{staticClass:"topcover"}),n("div",{attrs:{id:"wrapper"}},[n("div",{attrs:{id:"scroller"}},[n("div",{staticClass:"bulletList-l"},[t._m(0),t._l(t.barrageData,(function(e){return n("div",{staticClass:"bullet-item"},[n("div",{staticClass:"bullet-item-l",style:{color:e.colorSty}},[t._v(" "+t._s(t._f("nickNameFile")(e.nickName))+" ")]),n("div",{staticClass:"bullet-item-r"},[t._v(t._s(e.userOptMsg))])])})),n("div",{staticClass:"rollbottom",staticStyle:{height:"1px"}})],2)])])]),n("div",{staticClass:"bulletList-r",style:{marginBottom:t.blrbottom+"rem"}},[n("img",{staticClass:"bullet-img",attrs:{src:"https://fileshop.zhiyousx.com/dkzs.png",alt:""},on:{click:function(e){return t.jumpMyClock()}}})])]),n("div",{staticClass:"bulletFoot"},[n("img",{attrs:{src:"https://fileshop.zhiyousx.com/myclock-9.png",alt:""},on:{click:t.jumpIndex}}),n("div",{staticClass:"bulletIssue"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.barrageContent,expression:"barrageContent"}],staticClass:"inputIssue",attrs:{placeholder:"说点什么呢？",type:"text"},domProps:{value:t.barrageContent},on:{input:function(e){e.target.composing||(t.barrageContent=e.target.value)}}}),n("img",{staticClass:"input-sub",attrs:{src:"https://fileshop.zhiyousx.com/myclock-10.png",alt:""},on:{click:function(e){return t.subMsg()}}})])])]),t.curSpotInfo.showOverLayBox?n("div",{staticClass:"bottom-box"},[n("div",{staticClass:"t"},[n("div",{staticClass:"l"},[n("div",{staticClass:"l-name",class:1==t.curSpotInfo.overLayBoxInfo.signTag?"active":""},[t._v(" "+t._s(t.curSpotInfo.overLayBoxInfo.sitesName)+" ")]),t.curSpotInfo.targetDistance?n("img",{staticClass:"l-img",attrs:{src:"https://fileshop.zhiyousx.com/dakaMap1.png"}}):t._e(),t.curSpotInfo.targetDistance?n("div",{staticClass:"l-distance"},[t._v("距你"+t._s(t.curSpotInfo.targetDistance))]):t._e()]),1!=t.curSpotInfo.overLayBoxInfo.signTag?n("div",{staticClass:"r"},[t._v(" 今日已打卡"+t._s(t.curSpotInfo.overLayBoxInfo.signNum)+"次")]):t._e()]),n("div",{staticClass:"nav"},[t.curSpotInfo.overLayBoxInfo.hisRealIndex?n("span",[t._v("历史真实指数 "+t._s(t.curSpotInfo.overLayBoxInfo.hisRealIndex)+"分")]):t._e(),t.curSpotInfo.overLayBoxInfo.hisRealIndex&&(t.curSpotInfo.overLayBoxInfo.useTechIndex||t.curSpotInfo.overLayBoxInfo.interactExpcIndex||t.curSpotInfo.overLayBoxInfo.experienceIndex)?n("span",[t._v(" | ")]):t._e(),t.curSpotInfo.overLayBoxInfo.useTechIndex?n("span",[t._v("运用科技指数 "+t._s(t.curSpotInfo.overLayBoxInfo.useTechIndex)+"分")]):t._e(),t.curSpotInfo.overLayBoxInfo.useTechIndex&&(t.curSpotInfo.overLayBoxInfo.interactExpcIndex||t.curSpotInfo.overLayBoxInfo.experienceIndex)?n("span",[t._v(" | ")]):t._e(),t.curSpotInfo.overLayBoxInfo.interactExpcIndex?n("span",[t._v("互动体验指数 "+t._s(t.curSpotInfo.overLayBoxInfo.interactExpcIndex)+"分")]):t._e(),t.curSpotInfo.overLayBoxInfo.interactExpcIndex&&t.curSpotInfo.overLayBoxInfo.experienceIndex?n("span",[t._v(" | ")]):t._e(),t.curSpotInfo.overLayBoxInfo.experienceIndex?n("span",[t._v("体验指数 "+t._s(t.curSpotInfo.overLayBoxInfo.experienceIndex)+"分")]):t._e()]),n("div",{staticClass:"content"},[t._v(t._s(t.curSpotInfo.overLayBoxInfo.introduce))]),n("div",{staticClass:"b"},[1!=t.curSpotInfo.overLayBoxInfo.signTag?n("div",{staticClass:"btn1",on:{click:function(e){return t.jumpScenicDetail(t.curSpotInfo.overLayBoxInfo.id)}}},[t._v("景点历史")]):t._e(),1!=t.curSpotInfo.overLayBoxInfo.signTag?n("div",{staticClass:"btn",on:{click:function(e){return t.dakaHandle(t.curSpotInfo.overLayBoxInfo)}}},[n("img",{attrs:{src:o("e9a1")}}),n("span",[t._v("打卡")])]):t._e(),1==t.curSpotInfo.overLayBoxInfo.signTag?n("div",{staticClass:"btn1",staticStyle:{width:"6.2rem"},on:{click:function(e){return t.jumpScenicDetail(t.curSpotInfo.overLayBoxInfo.id)}}},[t._v("景点历史")]):t._e()])]):t._e()])},u=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"bullet-item",staticStyle:{background:"rgba(218, 56, 28, 0.6)"}},[o("div",{staticClass:"bullet-item-top"},[o("span",{staticStyle:{"font-wight":"bold"}},[t._v("公告："),t._v("各位大明宫遗址守护人，欢迎来到大明宫打卡寻宝之旅。我们在景区挑选了9个标志景点，赶快开启定位，前往景点打卡吧~")])])])}],d=(o("99af"),o("4160"),o("fb6a"),o("a9e3"),o("b680"),o("ac1f"),o("5319"),o("1276"),o("159b"),new AMap.Icon({image:o("e6a0"),imageSize:new AMap.Size(30,35)})),g=new AMap.Icon({image:o("1451"),imageSize:new AMap.Size(30,35)}),f=new AMap.Icon({image:o("2f6e"),imageSize:new AMap.Size(20,23)}),m=new AMap.Icon({image:o("0bb1"),imageSize:new AMap.Size(52,52)}),h=new AMap.Icon({image:o("21d1"),imageSize:new AMap.Size(52,52)}),A=new AMap.Icon({image:o("1be8"),imageSize:new AMap.Size(52,52)}),v={data:function(){return{sitesMinderNum:"",spotArr:[],markerArr:[],curPosition:{},curSpotInfo:{showOverLayBox:!1,overLayBoxInfo:{}},showVideoSlide:!1,barrageData:[],barrageContent:"",colorArr:["#a4ffd1","#ffcbcb","#f6a2f3","#ffa42f","#e35e5e","#a5fcff","#c3ff9b","#fff887","#a4ffd1"],notice:"",aspeed:10,perspeed:.01557632398753894,gundongAni:{},blrbottom:0}},filters:{nickNameFile:function(t){return t.length>5?(t=t.substring(5,0)+"*",t):t}},created:function(){},mounted:function(){this._paramObj=JSON.parse(decodeURIComponent(getRequestValue("obj"))),this._mchId=this._paramObj.mchId||28,this._shareUserId=this._paramObj.shareUserId||"",this._token=this._paramObj.token||"",this._mapObj,this._geolocation,this.initMap(),this.showVideo(),this.getSitesMinder(),this.getVisit(),this._myScroll,this._animatFg=!0,this._maxLen=20,this.initScroll(),this._socket=new WsSocket({url:"".concat(SocketHost,"/signLayer/").concat(this._mchId),onMessage:this.onMessage}),this._socket.connect(),this.getAdvertisement()},beforeDestroy:function(){this._socket.close()},methods:{initScroll:function(){var t=this;this._myScroll=new IScroll("#wrapper",{scrollY:!0,freeScroll:!0}),this._myScroll.on("scrollStart",(function(){t.bulletScroll({type:"start",obj:this},t)})),this._myScroll.on("scrollEnd",(function(){t.bulletScroll({type:"end",obj:this},t)}))},initMap:function(){var t=this,e=new AMap.ImageLayer({url:o("6d31"),bounds:new AMap.Bounds([108.955493,34.304414],[108.971329,34.280304])});this._mapObj=new AMap.Map("container",{resizeEnable:!0,center:[108.964119,34.292467],zoom:15,layers:[new AMap.TileLayer,e]}),this._mapObj.on("click",(function(e){t.setSpotIcon(),t._mapObj.panTo([108.964119,34.292467]),t._mapObj.setZoom(15),t.curSpotInfo.showOverLayBox=!1,t.blrbottom=0})),this.getSpotInfo()},showVideo:function(){var t=this;_AJAX({url:AJAX_URL_USER+"/api/manager/app/scenicSpot/getVideoOnOff",success:function(e){t.showVideoSlide=e.data}})},getSpotInfo:function(){var t=this;_AJAX({headers:{Authorization:this._token},url:AJAX_URL_USER+"/api/sign/app/sites/list/"+this._mchId,success:function(e){0===e.code?(t.spotArr=e.data,t.initGeolocationObj(),t.addMarkerIntoMap()):layer.msg(e.msg)}})},initGeolocationObj:function(){var t=this;this._mapObj.plugin("AMap.Geolocation",(function(){t._geolocation=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0,convert:!0,showButton:!1,buttonPosition:"LB",buttonOffset:new AMap.Pixel(10,20),showMarker:!0,showCircle:!0,panToLocation:!1,zoomToAccuracy:!1}),t._mapObj.addControl(t._geolocation),t._geolocation.getCurrentPosition((function(e,o){if("complete"==e){var n=o.position.getLat(),a=o.position.getLng();t.curPosition={lat:n,lng:a};var i=[];t.spotArr.forEach((function(e){var o=Number(e.latRange.split("-")[0]),s=Number(e.latRange.split("-")[1]),r=Number(e.lngRange.split("-")[0]),c=Number(e.lngRange.split("-")[1]);if(n>o&&n<s&&a>r&&a<c&&(e.lat=e.coordinate.split(",")[0],e.lng=e.coordinate.split(",")[1],i.push(e)),i.length>0){var l="";i.forEach((function(e){e.distance=t.GetDistance(n,a,e.lat,e.lng),l?e.distance<l.distance&&(l=e):l=e})),t._mapObj.panTo([l.lng,l.lat]),t._mapObj.setZoom(17),t.setSpotIcon(l.id),t.getScenicData(l.id)}}))}}))}))},getSitesMinder:function(){var t=this;_AJAX({headers:{Authorization:this._token},url:AJAX_URL_USER+"/api/sign/app/signShare/sitesMinder",type:"post",contentType:"application/json;charset=utf-8",data:JSON.stringify({mchId:this._mchId}),success:function(e){0===e.code?t.sitesMinderNum=e.data:layer.msg(e.msg)}})},getVisit:function(){_AJAX({headers:{Authorization:this._token},url:AJAX_URL_USER+"/api/sign/app/signShare/visit",type:"post",contentType:"application/json;charset=utf-8",data:JSON.stringify({mchId:this._mchId,shareUserId:this._shareUserId}),success:function(t){}})},addMarkerIntoMap:function(){var t=this,e=this;this.spotArr.forEach((function(o){var n=o.coordinate.split(",")[0],a=o.coordinate.split(",")[1];o.lat=n,o.lng=a;var i=new AMap.Marker({position:new AMap.LngLat(a,n)});0==o.signTag?i.setIcon(d):1==o.signTag?i.setIcon(g):i.setIcon(f),i.setLabel({content:o.sitesName,direction:"bottom"}),i.spotInfoObj=o,t.markerArr.push(i),t._mapObj.add(i),AMap.Event.addListener(i,"click",(function(t){var o=t.target.spotInfoObj;e._mapObj.panTo([o.lng,o.lat]),e._mapObj.setZoom(17),e.setSpotIcon(o.id),e.getScenicData(o.id)}))}))},setSpotIcon:function(t){this.markerArr.forEach((function(e){0==e.spotInfoObj.signTag?e.setIcon(d):1==e.spotInfoObj.signTag?e.setIcon(g):e.setIcon(f),e.spotInfoObj.id==t&&(0==e.spotInfoObj.signTag?e.setIcon(m):1==e.spotInfoObj.signTag?e.setIcon(h):e.setIcon(A))}))},getScenicData:function(t){var e=this;_AJAX({headers:{Authorization:e._token},url:AJAX_URL_USER+"/api/sign/app/sites/detail/"+t,success:function(t){if(0===t.code){if(t.data.introduce){var o=t.data.introduce.replace(/<\/?[^>]*>/g,"");o=o.replace(/\n[\s| | ]*\r/g,"\n"),t.data.introduce=o}e.curSpotInfo.showOverLayBox=!0,e.curSpotInfo.overLayBoxInfo=t.data,e.blrbottom=2;var n=e.curSpotInfo.overLayBoxInfo.coordinate.split(","),a={lat:n[0],lng:n[1]},i=0;i=e.GetDistance(e.curPosition.lat,e.curPosition.lng,a.lat,a.lng),0==i?i="0m":i>0&&i<1?i=(1e3*i).toFixed(1)+"m":i>=1&&(i=i.toFixed(1)+"km"),e.curSpotInfo.targetDistance=i}else layer.msg(t.msg)}})},jumpSpotPage:function(){wx.miniProgram.navigateTo({url:"/pages/hotTourList/hotTourList?mchId="+this._mchId})},jumpRoute:function(){wx.miniProgram.navigateTo({url:"/pages/tourRouteH5/tourRouteH5?url="+encodeURIComponent(HOST_URL+"/dataStatistics/tourRoute.html")+"&obj="+encodeURIComponent(JSON.stringify(this._paramObj))})},jumpScenicDetail:function(t){wx.miniProgram.navigateTo({url:"/pages/dakaScenicDetail/dakaScenicDetail?id="+t+"&targetDistance="+this.curSpotInfo.targetDistance+"&mchId="+this._mchId})},jumpVideo:function(){wx.miniProgram.navigateTo({url:"/pages/sceneryVideo/sceneryVideo?mchId="+this._mchId})},Rad:function(t){return t*Math.PI/180},GetDistance:function(t,e,o,n){var a=this.Rad(t),i=this.Rad(o),s=a-i,r=this.Rad(e)-this.Rad(n),c=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(a)*Math.cos(i)*Math.pow(Math.sin(r/2),2)));return c*=6378.137,c=Math.round(1e4*c)/1e4,c},dakaHandle:function(t){var e=this,o=t,n=Number(o.latRange.split("-")[0]),a=Number(o.latRange.split("-")[1]),i=Number(o.lngRange.split("-")[0]),s=Number(o.lngRange.split("-")[1]);this._geolocation.getCurrentPosition((function(t,r){if("complete"==t){var c=r.position.getLat(),l=r.position.getLng();c>n&&c<a&&l>i&&l<s?_AJAX({headers:{Authorization:e._token},url:AJAX_URL_USER+"/api/sign/app/sites/sign",type:"post",contentType:"application/json;charset=utf-8",data:JSON.stringify({sitesId:o.id}),success:function(t){0===t.code?wx.miniProgram.navigateTo({url:"/pages/dakaDetail/dakaDetail?mchId="+e._mchId+"&sitesId="+o.id+"&signId="+t.data+"&backType=1"}):layer.msg(t.msg)}}):layer.msg("您暂不在打卡范围内，可先查看景点热度")}}))},bulletScroll:function(t,e){e._myScroll.refresh();var o=t.type,n=t.obj;"start"===o&&(e._animatFg=!1),"end"===o&&n.y<=n.maxScrollY+24&&(e._animatFg=!0)},onMessage:function(t){try{var e=JSON.parse(t);this.setBarrage(e),console.info("onMessage-parse-success",e)}catch(o){console.error("onMessage-parse-error",t)}},setBarrage:function(t){var e=this,o=this.barrageData;t.colorSty=this.getRandomColor(),o.push(t),o.length>this._maxLen&&(o=o.slice(1)),this.barrageData=o,this.$nextTick((function(){e._myScroll&&e._animatFg&&(e._myScroll.refresh(),e._myScroll.scrollToElement(document.querySelector(".rollbottom")))}))},getRandomColor:function(){var t=Math.floor(Math.random()*(this.colorArr.length-1));return this.colorArr[t]},subMsg:function(){var t=this;if(this.barrageContent){var e={content:this.barrageContent,mchId:this._mchId};_AJAX({headers:{Authorization:this._token},url:AJAX_URL_USER+"/api/sign/app/layer/sign/edit",type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),success:function(e){0===e.code?t.barrageContent="":layer.msg(e.msg)}})}else layer.msg("请输入内容后，再进行提交")},jumpMyClock:function(){wx.miniProgram.navigateTo({url:"/pages/myClock/myClock?id="+this._mchId})},jumpIndex:function(){wx.miniProgram.redirectTo({url:"/pages/empty/empty?jumpto=index"})},getAdvertisement:function(){var t=this;_AJAX({headers:{Authorization:this._token},url:AJAX_URL_USER+"/api/manager/app/scenicSpot/getAdvertisement/"+this._mchId,success:function(e){0===e.code?(t.notice=e.data,t.$nextTick((function(){var e=document.querySelector(".gundongList"),o=t.perspeed*(2*e.clientWidth+418);t.aspeed=o,t.gundongAni={animation:"geiwogun ".concat(o,"s linear infinite")}}))):layer.msg(e.msg)}})}}},I=v,b=(o("61ec"),Object(s["a"])(I,p,u,!1,null,null,null)),S=b.exports;n["a"].component("map-daka",S),n["a"].config.productionTip=!1;var x=new n["a"]({render:function(t){return t(l)}}).$mount("#app");e["default"]=x},"61ec":function(t,e,o){"use strict";var n=o("8fa2"),a=o.n(n);a.a},"6d31":function(t,e,o){t.exports=o.p+"assets/img/bg.60de3388.png"},"8fa2":function(t,e,o){},ac60:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAoCAYAAAC8cqlMAAAE00lEQVRoQ82ZWazdUxTGf1/MY4h5DFrVIoZoghfDgzRIUUMTKS+GoJSqoZoYYnhoKmoKVRovEpQKEpQSaSKIMRJVEiFirKDxolpSS75m/699tnP+Z7jn5pz1dO/e57/X+vZea+21vi3GQCLiGGAxsDNws6SnxkBNw5Lqp4KI2B64C7gS2DytHcAUSa93qisi/O3ekr7t9Ju+AYmIM4EHgf2aKF8p6eROjYqI6cATwBLgNkm/tvt21EAiYt8E4KwaZeskbdfOmGo+IlYCJ6b/1wJXtXPPnoFExGZWkFzJLlUrkjrSFRFHAx83WcwxN0vS380UdbR4+WEWzA7qUqxoITA3n+gCiE/iMeDgJmsvB86VtK6cGwESEVsClwPnA4cD5S7/AawCdgMOarH973gNSZ9GhIN8RDoF4g+SLdcAtwPbFLpeA86Q9FfD+unDfYCXgKPauUiL+d+BecCjkv5Ja/YMJIsVb+jzwPhC72JJ3vT/Niqhf28UIJ4GrpW0Jl94NCdSrGMP8Ck4dnKZIenJakARMQt4oIeT+Nr3haRXm33bLyDpdA3Gm31gpus3YJKkXzxmIO8Cx2U/sGEXSfqp2Jk9galpsYXtcnunQCLidOAc4LJWGSmBcWJxDDqWK1kkaWYFZEMx6Ru1AUQPp+WAbRsjEeGk8RGwE+Ay5kJJG1vpi4jrgbuzeWfI8a4AfCJtFY4FkIjYFni7iE3f4nfUANkCWF0E/wJJcwcJxBXBm8V94dOYLOmTGjDOVouy+R9dFg0MSPJ7g3kf2CszbLmk02qA7AjY9X2ilRw7UCAJjI1+OTPKrn6YpM9rwDwDnJfNzx44kASmzJy3SrqzBohv/fuy+WXDAsQp9KHMsDcknVIDxNeFwVeyeliAuAT5MjNsjaQ8bhowRYRLqu+zwbXDAmQrYH1m2AZJW9eciAvJvALeOCxAbPSfmeHrJZVV78h0RAwtkEOALzIgP0hyam4qw+xaVwP3Z1avkDSlBsjxqe4aumD/EMi7zXmS5neRfp8deIxExNnAc5nRbswmSPqqBshSwExLJYO9ECNiIvAWsGtm1AuSprXJWD8DO2S/GVyJEhETEojdM4Nclh8hKQ/88g651C11NvgNMG5grpVYyQ8An0olN0rK+40SRLMyflM5YyCDbKwOTdWvybvHgUskNfRHOZKIuAFYUJzgOEnfNWt1XwEubkIm7GEaBjgAuLePre6M1GrPbtMdmlHxCeY3/gibYiBlDm8VZ+W4yYeZksxw/E/62XlGhOPI3WROC5lKnZiTD65zzFAc2SmC4nfuteeMIR1k0sOd5KRMr91vuqRl1dgmpjFd+aMl6EyRLukzQTc5kRIlQWfXnpNvaEmZXgFckNCX7Lmrzc+AXWooUx+/KdNVo3GtiLCXuHkyEeG/c7ErTy2po15JbO/UI0VZUSnzXXAPcFPDjnXOxp+Q3kb2b+LqK4BptSR2t/GRXpX8rOCWtJ/PCk7JJsvzTXZMuIO8riSvG2KkWxBFbvcLlV+q/GLVSrp96HG8moG0mBr1dfBinZ09uVaLdOsXKwNq1kd0+/R2EuD77GFgfrs7y/b0DUjKfi7k7Gp2Ob9obRoGTm1137Ta5YgwdWvyrSPpK5BKY0RUycDP07fk9H9HVvXwo38BShZ2PLLCX4cAAAAASUVORK5CYII="},e6a0:function(t,e,o){t.exports=o.p+"assets/img/yida.b980475d.png"},e9a1:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAlCAYAAADIgFBEAAACw0lEQVRYhcXYTUgUYRzH8VEPgl68iiev4UXQiAIPHTx46GAHDwUdDJbW1nxBEARxfaHWFl0XwgrEBNOygxVaBm0RFaXgIcSgU14Ebworzew8M8+3g7vrOro7M+u+/GBu8/s/H4aH2XlWUWwC+IEo8AdotLvf0m2M96KA3033rGH1nMy6y/66pV9/HkyrZdiey/6epd+aLaQU6LQMOwQeuLgOLf1OoNQNohzoAXbIT3bi88vtIHXAdp4Q1vwG6tJBGoD9AkES2QcarJBqTm+2QmUPqE7FvCwSJJFXqftEFhkjgToFCBQZkkhAATbyNl4XyKE55GUf9E6DLjLdvaEAB3mD9D9FXvEhL3VAoxe+/MrUOFDIx37RBXJgBrOp6xhz0QvbGd+jUnG8gGkio//s7xMG5uAs5tUeZBJzF+Y/2lYdYeR+FG34GaovhD77DgwzPWR4DrO5LwXT6QjiGCMim6hdYTTfFFrHBPqTN6dBwsAYm8do6Y9jepFN3Y4hjjHG9l/Ue2FUXwjVO4HmCSKmXx+DhIEZWMC4NoDR0o+RwDx3DnGMARAfNlB9ITTvJJoniNY+jni0DDEdI7iEuD6YxJjNfciFiCuIKwyAeP8TzTtJzBMkdnuc2K376B0hRJv/BEYufnINcY0BMFZ+oHmCxNqPMLGbo+gpGPkiO0gCk/G1eFbE2+9JjH5jNPlkzKXPWUMAoQC72TSN5a9JjN7mR37bOg8EYFcBVrNtG5FNRGARM7J5XgjAqgJ4czEpB7mjAFXk68fSeQ6AqsQHVleRMd3WM9JKkSCrWM9SQCWwVmDIGlCZ7rhSBgwCap4RanydsowHuTiqBhgBtoA03wuuY8bnjQA1tog0sAqgFrgQv2YcLv44pVMLVGQFsMGVANM2kDBQkvPFM4Cm0kAeFgRxBmrcAhkrCiQFNMTR32QDRYXkOv8Ba8Djd24wdWkAAAAASUVORK5CYII="}});
//# sourceMappingURL=index3.f99bd90a.js.map